javascript:(function(){if(document.getElementById('pm-fuzzer-v4'))return;var a=document.createElement('div');a.id='pm-fuzzer-v4';a.style.cssText='position:fixed;top:20px;right:20px;width:450px;height:600px;background:#1a1a1a;color:#00ffcc;z-index:9999999;font-family:monospace;border:1px solid #444;box-shadow:0 10px 30px rgba(0,0,0,0.9);border-radius:5px;display:flex;flex-direction:column;';var b=document.createElement('div');b.style.cssText='padding:10px;background:#252525;border-bottom:1px solid #444;display:flex;justify-content:space-between;align-items:center;font-weight:bold;';b.innerHTML='<span>PM Fuzzer V4 (Pro Edition)</span>';var c=document.createElement('button');c.textContent='X';c.style.cssText='background:#cc0000;color:white;border:none;cursor:pointer;padding:2px 8px;border-radius:3px;font-weight:bold;';c.onclick=function(){a.remove()};b.appendChild(c);a.appendChild(b);var d=document.createElement('div');d.id='pm-log';d.style.cssText='flex-grow:1;overflow-y:auto;padding:10px;font-size:12px;border-bottom:1px solid #444;background:#111;word-break:break-all;';d.innerHTML='<div style="color:#888;">/* Ready to fire. Supports String, JSON, XML. */</div>';a.appendChild(d);var e=document.createElement('div');e.style.cssText='padding:10px;background:#222;';var f=document.createElement('div');f.style.cssText='display:flex;gap:5px;margin-bottom:5px;';var g=document.createElement('select');g.style.cssText='flex-grow:1;background:#333;color:#fff;border:1px solid #555;padding:5px;font-family:monospace;';g.innerHTML='<option value="self">Target: Self</option><option value="parent">Target: Parent</option><option value="opener">Target: Opener</option><option value="frame0">Target: frames[0]</option><option value="frame1">Target: frames[1]</option>';var h=document.createElement('select');h.style.cssText='flex-grow:1;background:#333;color:#fff;border:1px solid #555;padding:5px;font-family:monospace;';h.innerHTML='<option value="string">Format: Raw String (XML/Text)</option><option value="json">Format: Parsed JSON Object</option><option value="auto">Format: Auto-Detect</option>';f.appendChild(g);f.appendChild(h);e.appendChild(f);var i=document.createElement('textarea');i.placeholder='Enter payload...';i.style.cssText='width:100%;height:80px;background:#111;color:#fff;border:1px solid #555;padding:5px;font-family:monospace;box-sizing:border-box;resize:none;margin-bottom:5px;';i.value='{"type":"load-channel","url":"javascript:print()"}';e.appendChild(i);var j=document.createElement('div');j.style.cssText='display:flex;gap:5px;';var k=document.createElement('button');k.textContent='FIRE PAYLOAD';k.style.cssText='flex-grow:1;background:#00cc00;color:black;border:none;padding:8px;font-weight:bold;cursor:pointer;';var l=document.createElement('button');l.textContent='Clear';l.style.cssText='background:#444;color:white;border:none;padding:8px;cursor:pointer;';l.onclick=function(){d.innerHTML=''};j.appendChild(k);j.appendChild(l);e.appendChild(j);a.appendChild(e);document.body.appendChild(a);function m(){var n=i.value;if(!n)return;var o=n,p='Raw String',q='#00ccff';if(h.value==='json'){try{o=JSON.parse(n);p='JSON Object';q='#00ff00'}catch(r){alert('Invalid JSON format!');return}}else if(h.value==='auto'){try{o=JSON.parse(n);p='JSON Object (Auto)';q='#00ff00'}catch(r){o=n;p='Raw String (Auto)';q='#00ccff'}}else{if(n.trim().startsWith('<')&&n.trim().endsWith('>')){p='XML / HTML String';q='#ff9900'}}var s=window,t='Self';try{if(g.value==='parent'){s=window.parent;t='Parent'}else if(g.value==='opener'){s=window.opener;t='Opener'}else if(g.value==='frame0'){s=window.frames[0];t='frames[0]'}else if(g.value==='frame1'){s=window.frames[1];t='frames[1]'}}catch(r){alert('Cannot access target window. It may not exist or is blocked by Cross-Origin rules.');return}if(!s){alert('Target window not found!');return}s.postMessage(o,'*');var u=document.createElement('div');u.style.cssText='margin-bottom:8px;border-bottom:1px dashed #333;padding-bottom:5px;';var v=new Date().toLocaleTimeString().split(' ')[0];var w=typeof o==='object'?JSON.stringify(o):o.replace(/</g,'&lt;').replace(/>/g,'&gt;');u.innerHTML=%60<span style="color:#666">[${v}]</span> <span style="color:#ccc">To: ${t}</span> | <span style="color:${q};font-weight:bold;">${p}</span><br><span style="color:#fff;">${w}</span>%60;d.appendChild(u);d.scrollTop=d.scrollHeight}k.onclick=m;i.addEventListener('keydown',function(n){if(n.ctrlKey&&n.key==='Enter')m()})})();
